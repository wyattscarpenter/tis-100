@0
#THE DEMUXER IS A
#FLUSH LEFT/RIGHT
#COULD MAYBE BE DE
#FINED BY ANY AND
#TIMING, IF THE
#TIMING WORKS OUT

#WAIT, NO, IT HAS
#TO BE THE OTHER
#PORT, ANYWAY, NVM

#POSSIBLY: SET ALL
#SEQUENCES TO BE
#SOME EQUAL FIXED
#LENGTH?

@1
1: MOV 40 ACC
SAV #COUNT
L: MOV UP ACC
L': MOV ACC DOWN
L*: SWP #COUNT
    SUB 1
    JEZ 1 #COUNT
    SWP
    JGZ L #NUMBER
    MOV 0 ACC
JMP L

@2
1: MOV 40 ACC
SAV #COUNT
L: MOV UP ACC
L': MOV ACC DOWN
L*: SWP #COUNT
    SUB 1
    JEZ 1 #COUNT
    SWP
    JGZ L #NUMBER
    MOV 0 ACC
JMP L

@3
1: MOV UP ACC

L: MOV ACC RIGHT

SAV
MOV RIGHT ACC
JLZ 1
SWP
JMP L

@4
1:
L1: MOV LEFT DOWN
R1: MOV RIGHT DOWN
FD: MOV DOWN RIGHT
    MOV DOWN LEFT
R2: MOV RIGHT DOWN
JMP 1
FL: MOV RIGHT ACC
  MOV ACC DOWN
  JEZ 1
JMP FL

@5
1: MOV UP ACC

L: MOV ACC LEFT


SAV
MOV LEFT ACC
SWP
MOV ACC LEFT
SWP
JGZ 1
SWP
JMP L

@6
# THE REPEATERS
# TAKE A FEEDBACK
# OF -/+ TO CLEAR
# AND ANYTHING
# ELSE TO REPEAT.

#THEY OUTPUT TWIC
#E BECAUSE THAT'S
#WHAT THE DEMUXER
#NEEDS.

##SOLUTION
#COULD SIMPLY USE
#THE SORTER BUT
#THAT'S LAME

@7
#THIS IS THE SORTR
#ABOVE IT IS THE
#DEMUXER

#THE SORTER NEEDS
#FROM THE MUXER
#L,R,R
#(F IS 0 IF FLUSH)

#THE DEMUXER NEEDS
#FEEDBACK OF + FOR
#LEFT AND - FOR
#RIGHT HAVING BEEN
#USED UP

@8
1: MOV UP ACC
JGZ NF #NOT FLUSH
JMP 1

NF: SUB UP
MOV ACC UP
MOV ACC UP
JGZ R#L-R>0;L>R;R!
L: ADD UP
  MOV ACC DOWN
JMP 1
R:  MOV UP DOWN